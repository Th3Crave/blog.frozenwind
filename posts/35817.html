<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="人生到处知何似，应似飞鸿踏雪泥。泥上偶然留指爪，鸿飞那复计东西。"><title>Linux常用命令总结 | frozeNwInd</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?' + 'bbf19a98c9ae28f2e1e8cfcee1d9585e';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Linux常用命令总结</h1><a id="logo" href="/.">frozeNwInd</a><p class="description">吕乘风的博客</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tags/"><i class="fa fa-tag"> 标签</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/history/"><i class="fa fa-history"> 历史</i></a><a href="/message/"><i class="fa fa-comment"> 留言</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Linux常用命令总结</h1><div class="post-meta">2019-08-21<span> | </span><span class="category"><a href="/categories/technology/">technology</a><a href="/categories/technology/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="post-content"><h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><h3 id="服务器ip、端口连通情况"><a href="#服务器ip、端口连通情况" class="headerlink" title="服务器ip、端口连通情况"></a>服务器ip、端口连通情况</h3><ul>
<li>ping<br>  ping出域名对应的服务器ip</li>
<li>telnet<br>  telnet ip port</li>
<li>nc -vz -w2 ip port<br>  mac测试远程端口是否正常，netcat</li>
</ul>
<h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><h4 id="find"><a href="#find" class="headerlink" title="find"></a>find</h4><p>linux下面根据文件名，查找文件路径：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name 具体目录名 -<span class="built_in">print</span></span><br></pre></td></tr></table></figure>


<h2 id="linux性能监控命令"><a href="#linux性能监控命令" class="headerlink" title="linux性能监控命令"></a>linux性能监控命令</h2><h3 id="top"><a href="#top" class="headerlink" title="top"></a>top</h3><p>可以实时显示系统中各个进程的占用情况。<br><img src="/posts/35817/top.png"><br>上部分列出了系统整体的统计信息：任务、CPU、内存、交换区等信息。<br>下部分列出进程的详细情况。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参数说明：</span><br><span class="line">d : 监控内容刷新的时间间隔。</span><br><span class="line">p : 只监控指定PID的进程。</span><br><span class="line">H : 显示进程下的线程，一般结合p参数使用，查看某个进程下的线程，例如: top -Hp 8080。</span><br><span class="line">c : 切换显示模式，只显示名称，或者显示完整的路径与名称。</span><br><span class="line">s : 安全模式，交谈式指令无法使用, 例如k指令。</span><br><span class="line">i : 不显示任何闲置或无用的进程，也可以理解成只显示正在执行的进程。</span><br><span class="line">n : 限定监控内容刷新的次数，完成后将会退出 top 视图。例如 top -n 5，默认3秒刷新一次，那么在15s后，自动退出top视图。</span><br></pre></td></tr></table></figure>


<h3 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h3><p>可以查看系统负载。显示的和top命令第一行一样。<br><img src="/posts/35817/uptime.png"></p>
<h3 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h3><p>查看所有进程<br><img src="/posts/35817/ps.png"></p>
<ul>
<li>grep<br>  全局正则表达式文本</li>
<li>ps -ef<br>  用标准格式显示进程</li>
<li>ps aux<br>  用BSD格式来显示进程</li>
<li>ps -T -p [进程id]<br>  查看进程下的线程</li>
</ul>
<h3 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h3><p>这个命令用来查看当前建立的网络连接(深刻理解netstat每一项代表的含义)。最经典的案例就是查看本地系统打开了哪些端口：<br><img src="/posts/35817/netstat.png"></p>
<h3 id="vmstat"><a href="#vmstat" class="headerlink" title="vmstat"></a>vmstat</h3><p>可以用来监控虚拟内存。可对操作系统的虚拟内存、IO、CPU等多个指标的整体情况进行监视。<br><img src="/posts/35817/vmstat.png"></p>
<ul>
<li><p>内存方面：<br>  swpd：已经使用的交换内存（kb）<br>  free：空闲的物理内存（kb）<br>  buff：用作缓冲区的内存数（kb）<br>  cache：用作高速缓存的内存数（kb）<br>  si、so 两列，表示磁盘和内存之间交换的频繁程度。</p>
<p>  分析思路：<br>  如果 si、so 数值长期很大并且free长期很小，表示物理内存不能满足需要，也就是内存不足。由于磁盘的性能比内存是慢很多的，所以如果存在大量的页面交换，那么系统的性能必然会受到很大影响。</p>
</li>
<li><p>CPU方面：<br>  r：展示了正在执行和等待cpu资源的任务个数。当这个值超过了cpu个数，就会出现cpu瓶颈。<br>  us：用户CPU时间。<br>  sy：系统CPU时间。<br>  id：空闲CPU时间。<br>  wa：等等I/O CPU时间。<br>  us+sy+id+wa=100%</p>
<p>  分析思路：<br>  如果 r 经常大于4，且id经常小于40，表面CPU的负荷很重。</p>
</li>
</ul>
<h3 id="pidstat"><a href="#pidstat" class="headerlink" title="pidstat"></a>pidstat</h3><p>pidstat，观测单个进程的性能情况</p>
<h3 id="free"><a href="#free" class="headerlink" title="free"></a>free</h3><p>可以用来观察内存使用情况。<br><img src="/posts/35817/free.png"></p>
<p>total= used + free<br>分析思路：<br>当 –/+ buffers/cache中的free长时间接近0，且 swap used长时间比较大时，说明物理内存已经不够用了，需要升级内存或降低内存的使用量。</p>
<h3 id="iostat"><a href="#iostat" class="headerlink" title="iostat"></a>iostat</h3><p>可以用来监控磁盘I/O的情况。<br><img src="/posts/35817/iostat.png"></p>
<h3 id="磁盘命令"><a href="#磁盘命令" class="headerlink" title="磁盘命令"></a>磁盘命令</h3><h4 id="df-（disk-free）"><a href="#df-（disk-free）" class="headerlink" title="df （disk free）"></a>df （disk free）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-a：全部文件系统列表，包含虚拟文件系统</span><br><span class="line">-B：指定显示scale size，比如以M，G为单位显示</span><br><span class="line">-h：方便人阅读方式显示。</span><br><span class="line">-H：和-h相似，不过其中1k = 1000byte， 1M=1000k</span><br><span class="line">-i：列出inode的信息</span><br><span class="line">-k ：区块为1024字节</span><br><span class="line">-l ：显示本地文件系统</span><br><span class="line">-p：使用POSIX规范输出</span><br><span class="line">-t：打印指定的文件系统类型</span><br><span class="line">-T：显示文件系统类型</span><br><span class="line">-x：不打印指定的文件系统类型</span><br></pre></td></tr></table></figure>

<h4 id="fdisk"><a href="#fdisk" class="headerlink" title="fdisk"></a>fdisk</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-l 列出素所有分区表</span><br></pre></td></tr></table></figure>




<h2 id="java性能监控命令"><a href="#java性能监控命令" class="headerlink" title="java性能监控命令"></a>java性能监控命令</h2><ul>
<li><p>top<br>  查看当前所有进程cpu、内存使用情况<br>  <strong>top -H -p [java pid]： 查看java进程下所有线程的情况</strong></p>
</li>
<li><p>ps<br>  ps -ef | grep java<br>  查看java进程</p>
</li>
<li><p>pidstat<br>  pidstat -p [java pid]<br>  进程监控命令</p>
<p>  安装方式：<br>  Debian/Ubuntu：apt-get install sysstat<br>  CentOS/Fedora/RHEL：yum install sysstat</p>
</li>
<li><p>jstat </p>
</li>
<li><p>jstack</p>
</li>
<li><p>jps</p>
</li>
<li><p>jmap</p>
</li>
</ul>
<h3 id="Java线上故障"><a href="#Java线上故障" class="headerlink" title="Java线上故障"></a>Java线上故障</h3><p>线上故障主要会包括 CPU、磁盘、内存以及网络问题，而大多数故障可能会包含不止一个层面的问题，所以进行排查时候尽量四个方面依次排查一遍。<br>基本上出问题就是 df、free、top 三连，然后依次 jstack、jmap 伺候，具体问题具体分析即可。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39609166/article/details/114825626">https://blog.csdn.net/weixin_39609166/article/details/114825626</a></p>
<h4 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h4><p>异常常见原因：</p>
<ol>
<li>业务逻辑问题（死循环）</li>
<li>频繁gc</li>
<li>上下文切换过多</li>
</ol>
<p>CPU问题排查步骤</p>
<ol>
<li>执行<code>top</code>命令：查看所有进程占系统CPU的排序。极大可能排第一个的就是咱们的java进程（COMMAND列）。PID那一列就是进程号。</li>
<li>执行<code>top -H -p 进程号</code>命令：查看java进程下的所有线程占CPU的情况。<br> -H参数：显示进程下的线程，一般结合p参数使用，查看某个进程下的线程，例如: top -H -p 1。</li>
<li>执行<code>printf &quot;%x\n&quot; 线程号</code>命令 ：后续查看线程堆栈信息展示的都是十六进制，为了找到线程堆栈信息，需要把线程号转成16进制。<br> 例如, printf “%x\n” 10 -》打印：a，那么在jstack中线程号就是0xa。</li>
<li>执行<code>“jstack 进程号 | grep 线程ID”</code> 查找某进程下 -》线程ID（jstack堆栈信息中的nid）=0xa的线程堆栈信息。<br> 如果“”VM Thread” os_prio=0 tid=0x00007f871806e000 nid=0xa runnable”，第一个双引号圈起来的就是线程名，如果是“VM Thread”这就是虚拟机GC回收线程了</li>
<li>jstat</li>
<li>jmap</li>
</ol>
<h4 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h4><p>内存问题排查起来相对比 CPU 麻烦一些，场景也比较多。<br>主要包括：</p>
<ul>
<li>OOM</li>
<li>GC问题</li>
<li>堆外内存。</li>
</ul>
<h4 id="磁盘"><a href="#磁盘" class="headerlink" title="磁盘"></a>磁盘</h4><h4 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h4></div><div class="tags"><a href="/tags/操作系统"><i class="fa fa-tag">操作系统</i></a><a href="/tags/Linux"><i class="fa fa-tag">Linux</i></a></div><div class="post-nav"><a class="pre" href="/posts/27273.html">Redis</a><a class="next" href="/posts/9977.html">MySQL-前言</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
  clientID: '8359b7a19b78f2b9e112',
  clientSecret: '5ad69dc1633a1834322067d017b6313bd231457c',
  repo: 'gitalk',
  owner: 'Th3Crave',
  admin: ['Th3Crave'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar-toc"><div class="stoc-article" id="sidebar-stoc"><strong class="stoc-title"><i class="fa"> Contents </i></strong><div class="toc-nav" id="stoc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">常用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8ip%E3%80%81%E7%AB%AF%E5%8F%A3%E8%BF%9E%E9%80%9A%E6%83%85%E5%86%B5"><span class="toc-text">服务器ip、端口连通情况</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-text">文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#find"><span class="toc-text">find</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#linux%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4"><span class="toc-text">linux性能监控命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#top"><span class="toc-text">top</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uptime"><span class="toc-text">uptime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ps"><span class="toc-text">ps</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#netstat"><span class="toc-text">netstat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vmstat"><span class="toc-text">vmstat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pidstat"><span class="toc-text">pidstat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#free"><span class="toc-text">free</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#iostat"><span class="toc-text">iostat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A3%81%E7%9B%98%E5%91%BD%E4%BB%A4"><span class="toc-text">磁盘命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#df-%EF%BC%88disk-free%EF%BC%89"><span class="toc-text">df （disk free）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fdisk"><span class="toc-text">fdisk</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E5%91%BD%E4%BB%A4"><span class="toc-text">java性能监控命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Java%E7%BA%BF%E4%B8%8A%E6%95%85%E9%9A%9C"><span class="toc-text">Java线上故障</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CPU"><span class="toc-text">CPU</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E5%AD%98"><span class="toc-text">内存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A3%81%E7%9B%98"><span class="toc-text">磁盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C"><span class="toc-text">网络</span></a></li></ol></li></ol></li></ol></div><script type="text/javascript" src="/js/toc.js?v=1.0.0"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2024 <a href="/." rel="nofollow">frozeNwInd.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
  search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>